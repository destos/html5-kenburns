/*! HTML5 Kenburns - v0.0.2 - 2013-05-10
* https://github.com/destos/html5-kenburns
* Copyright (c) 2013 Patrick Forringer; Licensed MIT */
var Kenburns;Kenburns=function(){function t(e,t){var n,r,i,s;this.canvas=e,this.options=$.extend({},this.defaults,t),s=this.options.images;for(r=0,i=s.length;r<i;r++)n=s[r],this.images.push({path:n,initialized:!1,loaded:!1});this.options.fade_time=Math.min(this.options.duration/2,this.options.fade_time||1e3),this.options.solid_time=this.options.duration-this.options.fade_time*2,this.canvas.width=this.options.width,this.canvas.height=this.options.height,this.context=this.canvas.getContext("2d"),this}return t.prototype.defaults={duration:7e3,width:940,height:360,align:"random",zoom:1.1,debug:!1},t.prototype.canvas=null,t.prototype.images=[],t.prototype.interval=null,t.prototype.state="init",t.prototype.time=0,t.prototype.scale=1,t.prototype.aligns=["top","left","center","bottom","right"],t.prototype.get_image_info=function(e,t){var n,r,i,s=this;return i=this,r=this.images[e],r.initialized||(n=new Image,r.image=n,r.loaded=!1,r.reset_scale=function(){return this.scale=1},r.select_alignment=function(){return i.options.align==="random"?this.align=i.aligns[Math.floor(Math.random()*i.aligns.length)]:this.align=i.options.align},n.onload=function(){r.loaded=!0,r.width=s.canvas.width,r.height=Math.floor(s.canvas.width/n.width*n.height),r.x=(r.width-s.canvas.width)/2*-1,r.y=(r.height-s.canvas.height)/2*-1,r.reset_scale(),r.select_alignment();if(t)return t()},r.initialized=!0,n.src=r.path),r},t.prototype._get_time=function(){return new Dat,e().getTime()-this.start_time},t.prototype._log=function(e){if(this.options.debug)return console.log("jQuery.kenburns > %s",e)},t.prototype.start=function(){return this.exec()},t.prototype.scaling=function(e){var t,n,r;return r=Math.floor(e.width*e.scale),n=Math.floor(e.height*e.scale),t=this.align(e.x,e.y,e.width,e.height,r,n,e.align),{x:t.x,y:t.y,width:r,height:n}},t.prototype.align=function(e,t,n,r,i,s,o){var u,a;u=a=0;switch(o){case"top":u=(i-n)/2*-1;break;case"left":a=(s-r)/2*-1;break;case"bottom":u=(i-n)/2*-1,a=(s-r)*-1;break;case"right":u=(i-n)*-1,a=(s-r)/2*-1;break;default:u=(i-n)/2*-1,a=(s-r)/2*-1}return{x:e+u,y:t+a}},t.prototype.exec=function(){var e,t,n,r,i=this;if(this.state==="animated")return;return e=this.context,n=function(e){return(new Date).getTime()-e},r=function(e){return(e+i.images.length)%i.images.length},this.time===0&&(this.time=n(0)),this.state="animated",t=null,this.interval=setInterval(function(){var e,s,o,u,a,f,l,c,h,p;p=n(i.time),c=Math.floor(p/(i.options.duration-i.options.fade_time)),h=r(c),u=c*(i.options.duration-i.options.fade_time),f=p-u,f<i.options.fade_time&&(e=c-1,s=u-i.options.duration+i.options.fade_time,o=p-s,p<i.options.fade_time||i.render_image(r(e),o/i.options.duration,1)),i.render_image(h,f/i.options.duration,f/i.options.fade_time);if(i.options.frame_change&&t!==h)return l=r(c+1),a=i.get_image_info(l),a.reset_scale(),a.select_alignment(),i.options.frame_change(h,a),t=h},30)},t.prototype.render_image=function(e,t,n){var r,i,s;if(t>1)return;r=this.get_image_info(e);if(r.loaded){s=Math.min(1,n);if(s>0)return this.context.globalAlpha=Math.min(1,s),r.scale+=Math.abs(this.options.zoom-1)/this.options.duration*30,i=this.scaling(r),this.context.drawImage(r.image,0,0,r.width,r.height,i.x,i.y,i.width,i.height),this.context.save()}},t.prototype.set=function(e){return this.options=$.extend(this.options,e)},t.prototype.reset=function(){return this.time=0,this.state="reset",clearInterval(this.interval),this.start()},t.prototype.pause=function(){return this.state="paused",clearInterval(this.interval)},t.prototype.stop=function(){return this.time=0,this.state="stop",clearInterval(this.interval)},t}(),function(e){return e.fn.kenburns=function(t){var n;return n=arguments,this.each(function(){var r;return r=e(this).data("kenburns")||{},r[t]?r[t].apply(r,Array.prototype.slice.call(n,1)):typeof t=="object"||!t?(r=new Kenburns(this,t),e(this).data("kenburns",r)):e.error("Method "+t+" does not exist on jQuery.kenburns")})}}(jQuery);